<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Track visualization | BioSeqUtils Reference</title>
<meta name="author" content="Jun Zhang">
<meta name="description" content="There are multiple chapters to illustrate how to use trackVisProMax draw tracks. Raw fastq can be fetched CRA003985, You need download and map to genome and convert bam to bigwig. First we load...">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 4 Track visualization | BioSeqUtils Reference">
<meta property="og:type" content="book">
<meta property="og:description" content="There are multiple chapters to illustrate how to use trackVisProMax draw tracks. Raw fastq can be fetched CRA003985, You need download and map to genome and convert bam to bigwig. First we load...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Track visualization | BioSeqUtils Reference">
<meta name="twitter:description" content="There are multiple chapters to illustrate how to use trackVisProMax draw tracks. Raw fastq can be fetched CRA003985, You need download and map to genome and convert bam to bigwig. First we load...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">BioSeqUtils Reference</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="" href="extract-sequence.html"><span class="header-section-number">2</span> Extract sequence</a></li>
<li><a class="" href="track-data-input.html"><span class="header-section-number">3</span> Track data input</a></li>
<li><a class="active" href="track-visualization.html"><span class="header-section-number">4</span> Track visualization</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="track-visualization" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Track visualization<a class="anchor" aria-label="anchor" href="#track-visualization"><i class="fas fa-link"></i></a>
</h1>
<p>There are multiple chapters to illustrate how to use <strong>trackVisProMax</strong> draw
tracks.</p>
<blockquote>
<p>Raw fastq can be fetched <a href="https://ngdc.cncb.ac.cn/gsa/browse/CRA003985"><strong>CRA003985</strong></a>,
You need download and map to genome and convert bam to bigwig.</p>
</blockquote>
<p>First we load test data into R:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load bigwig files</span></span>
<span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"test-bw/"</span>,pattern <span class="op">=</span> <span class="st">'.bw'</span>,full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">file</span></span>
<span><span class="co"># [1] "test-bw/1cell-m6A-1.bw" "test-bw/1cell-m6A-2.bw" "test-bw/1cell-RNA-1.bw"</span></span>
<span><span class="co"># [4] "test-bw/1cell-RNA-2.bw" "test-bw/2cell-m6A-1.bw" "test-bw/2cell-m6A-2.bw"</span></span>
<span><span class="co"># [7] "test-bw/2cell-RNA-1.bw" "test-bw/2cell-RNA-2.bw"</span></span>
<span></span>
<span><span class="co"># select some chromosomes for test</span></span>
<span><span class="va">bw</span> <span class="op">&lt;-</span> <span class="fu">loadBigWig</span><span class="op">(</span><span class="va">file</span>,chrom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"5"</span>,<span class="st">"15"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bw</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#   seqnames   start     end   score    fileName</span></span>
<span><span class="co"># 1       15       1 3054635 0.00000 1cell-m6A-1</span></span>
<span><span class="co"># 2       15 3054636 3054640 1.34079 1cell-m6A-1</span></span>
<span><span class="co"># 3       15 3054641 3054715 2.68159 1cell-m6A-1</span></span>
<span></span>
<span><span class="co"># gtf</span></span>
<span><span class="va">gtf</span> <span class="op">&lt;-</span> <span class="fu">rtracklayer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/GFFFile-class.html">import.gff</a></span><span class="op">(</span><span class="st">"Mus_musculus.GRCm38.102.gtf"</span>,format <span class="op">=</span> <span class="st">"gtf"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div id="basic-plot" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Basic plot<a class="anchor" aria-label="anchor" href="#basic-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Plot with given one gene symbol (<strong><em>make sure the <u>gene_name</u> column in your annotation file</em></strong>):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmt2d"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t1.png" style="width:100.0%"></div>
<p>Plot multiple genes at the same time:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmt2d"</span>,<span class="st">"Dnaaf5"</span>,<span class="st">"Zfp68"</span>,<span class="st">"Pabpc1"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure">
<img src="local_images/t2.png" style="width:100.0%">
Change track colors with color vectors:</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmt2d"</span><span class="op">)</span>,</span>
<span>               sample_fill_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"red"</span>,<span class="st">"grey50"</span>,<span class="st">"grey50"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t3.png" style="width:100.0%"></div>
<p>Or you can give a named vector to assign colors for each track:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trmycol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1cell-m6A-1"</span> <span class="op">=</span> <span class="st">"orange"</span>, <span class="st">"1cell-m6A-2"</span> <span class="op">=</span> <span class="st">"orange"</span>, </span>
<span>           <span class="st">"1cell-RNA-1"</span> <span class="op">=</span> <span class="st">"green"</span>, <span class="st">"1cell-RNA-2"</span>  <span class="op">=</span> <span class="st">"green"</span>,</span>
<span>           <span class="st">"2cell-m6A-1"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"2cell-m6A-2"</span> <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>           <span class="st">"2cell-RNA-1"</span> <span class="op">=</span> <span class="st">"pink"</span>, <span class="st">"2cell-RNA-2"</span> <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmt2d"</span><span class="op">)</span>,</span>
<span>               sample_fill_col <span class="op">=</span> <span class="va">mycol</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t4.png" style="width:100.0%"></div>
<p>Adding genomic region label:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmt2d"</span>,<span class="st">"Dnaaf5"</span>,<span class="st">"Zfp68"</span><span class="op">)</span>,</span>
<span>               add_gene_region_label <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t5.png" style="width:100.0%"></div>
<p>Adding legend:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmt2d"</span>,<span class="st">"Dnaaf5"</span>,<span class="st">"Zfp68"</span><span class="op">)</span>,</span>
<span>               add_gene_region_label <span class="op">=</span> <span class="cn">T</span>,</span>
<span>               signal_layer_bw_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t6.png" style="width:100.0%"></div>
<hr>
</div>
<div id="signal-range-settings" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Signal range settings<a class="anchor" aria-label="anchor" href="#signal-range-settings"><i class="fas fa-link"></i></a>
</h2>
<p><strong>signal_range_pos</strong> can be used to change the y axis limitation range label position:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmt2d"</span>,<span class="st">"Dnaaf5"</span><span class="op">)</span>,</span>
<span>               signal_range_pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.85</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t7.png" style="width:100.0%"></div>
<p><strong>signal_range_label_params</strong> can be used to change the y label styles:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmt2d"</span>,<span class="st">"Dnaaf5"</span><span class="op">)</span>,</span>
<span>               signal_range_pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.85</span><span class="op">)</span>,</span>
<span>               signal_range_label_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>,color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t8.png" style="width:100.0%"></div>
<p>As you can see, the signal range is same by each column panel, you can set
<strong>fixed_column_range = F</strong> to make free scales for each panel:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmt2d"</span>,<span class="st">"Dnaaf5"</span>,<span class="st">"Zfp68"</span>,<span class="st">"Pabpc1"</span><span class="op">)</span>,</span>
<span>               fixed_column_range <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t9.png" style="width:100.0%"></div>
<p>Giving a named list with named vectors to control signal range for each panel:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1cell-m6A-1"</span>,<span class="st">"1cell-m6A-2"</span>,<span class="st">"1cell-RNA-1"</span>,<span class="st">"1cell-RNA-2"</span>,</span>
<span>            <span class="st">"2cell-m6A-1"</span>,<span class="st">"2cell-m6A-2"</span>,<span class="st">"2cell-RNA-1"</span>,<span class="st">"2cell-RNA-2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Kmt2d_rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">4000</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">8000</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">4000</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Kmt2d_rg</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sample</span></span>
<span><span class="va">Kmt2d_rg</span></span>
<span><span class="co"># 1cell-m6A-1 1cell-m6A-2 1cell-RNA-1 1cell-RNA-2 2cell-m6A-1 2cell-m6A-2 2cell-RNA-1 2cell-RNA-2 </span></span>
<span><span class="co"># 4000        4000        8000        8000        4000        4000        4000        4000 </span></span>
<span></span>
<span><span class="va">Dnaaf5_rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">5000</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2000</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Dnaaf5_rg</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sample</span></span>
<span><span class="va">Dnaaf5_rg</span></span>
<span><span class="co"># 1cell-m6A-1 1cell-m6A-2 1cell-RNA-1 1cell-RNA-2 2cell-m6A-1 2cell-m6A-2 2cell-RNA-1 2cell-RNA-2 </span></span>
<span><span class="co"># 1000        1000        5000        5000        2000        2000        2000        2000 </span></span>
<span></span>
<span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmt2d"</span>,<span class="st">"Dnaaf5"</span><span class="op">)</span>,</span>
<span>               signal_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Kmt2d <span class="op">=</span> <span class="va">Kmt2d_rg</span>,</span>
<span>                                   Dnaaf5 <span class="op">=</span> <span class="va">Dnaaf5_rg</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure">
<img src="local_images/t10.png" style="width:100.0%">
You can even set a range for a specified panel:</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmt2d"</span>,<span class="st">"Dnaaf5"</span><span class="op">)</span>,</span>
<span>               signal_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Kmt2d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1cell-m6A-1"</span> <span class="op">=</span> <span class="fl">8000</span><span class="op">)</span>,</span>
<span>                                   Dnaaf5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1cell-m6A-1"</span> <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t11.png" style="width:100.0%"></div>
</div>
<div id="transcript-track-settings" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Transcript track settings<a class="anchor" aria-label="anchor" href="#transcript-track-settings"><i class="fas fa-link"></i></a>
</h2>
<p>Here we illustrate some related parameters to draw the transcript track. <strong>trans_topN</strong> is
used to control how many transcripts for a gene to be drawn in the track. The default
is to show top 2 longest transcripts according to their transcipt exon length. You
can change it with other values:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dnaaf5"</span>,<span class="st">"Zfp68"</span>,<span class="st">"Pabpc1"</span><span class="op">)</span>,</span>
<span>               trans_topN <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t12.png" style="width:100.0%"></div>
<p>Showing top 5 transcripts:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dnaaf5"</span>,<span class="st">"Zfp68"</span>,<span class="st">"Pabpc1"</span><span class="op">)</span>,</span>
<span>               trans_topN <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t13.png" style="width:100.0%"></div>
<p><strong>collapse_trans</strong> parameter allows you to collapse all transcripts you have
shown in the <strong><em>trans</em></strong> track:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dnaaf5"</span>,<span class="st">"Zfp68"</span>,<span class="st">"Pabpc1"</span><span class="op">)</span>,</span>
<span>               trans_topN <span class="op">=</span> <span class="fl">5</span>,</span>
<span>               collapse_trans <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t14.png" style="width:100.0%"></div>
<p>Setting <strong>trans_topN = “all”</strong> which can show all transcripts for a gene:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dnaaf5"</span>,<span class="st">"Zfp68"</span>,<span class="st">"Pabpc1"</span><span class="op">)</span>,</span>
<span>               trans_topN <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t15.png" style="width:100.0%"></div>
<p>You can also collapse the transcripts:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dnaaf5"</span>,<span class="st">"Zfp68"</span>,<span class="st">"Pabpc1"</span><span class="op">)</span>,</span>
<span>               trans_topN <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>               collapse_trans <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t16.png" style="width:100.0%"></div>
<p><strong>rel_len</strong> control the arrow densities on transcript, you can check <strong>createSegment</strong>
function for details. <strong>arrow_rel_len_params_list</strong> accepts a list parameters to
control how the arrows be generated. <strong>rel_len</strong> smaller, the more arrows be generated:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Actb"</span>,<span class="st">"Myc"</span>,<span class="st">"Mtdh"</span><span class="op">)</span>,</span>
<span>               arrow_rel_len_params_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rel_len <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t17.png" style="width:100.0%"></div>
<p>More controls for arrows:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Actb"</span>,<span class="st">"Myc"</span>,<span class="st">"Mtdh"</span><span class="op">)</span>,</span>
<span>               arrow_rel_len_params_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rel_len <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span>,</span>
<span>               trans_exon_arrow_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span>,color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                                              linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t18.png" style="width:100.0%"></div>
<p>Changing arrow styles:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Actb"</span>,<span class="st">"Myc"</span>,<span class="st">"Mtdh"</span><span class="op">)</span>,</span>
<span>               arrow_rel_len_params_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rel_len <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span>,</span>
<span>               trans_exon_arrow_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>arrow <span class="op">=</span> <span class="fu">arrow</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"open"</span>,</span>
<span>                                                            length <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">3</span>,<span class="st">"mm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t19.png" style="width:100.0%"></div>
<p>Changing arrow colors:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Actb"</span>,<span class="st">"Myc"</span>,<span class="st">"Mtdh"</span><span class="op">)</span>,</span>
<span>               trans_exon_col_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"black"</span>,color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t20.png" style="width:100.0%"></div>
<p><strong>add_gene_label_layer</strong> allows you to mark gene symbols beside the transcript:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Actb"</span>,<span class="st">"Myc"</span>,<span class="st">"Mtdh"</span><span class="op">)</span>,</span>
<span>               collapse_trans <span class="op">=</span> <span class="cn">T</span>,</span>
<span>               add_gene_label_layer <span class="op">=</span> <span class="cn">T</span>,</span>
<span>               gene_label_shift_y <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t21.png" style="width:100.0%"></div>
<p><strong>exon_width</strong> allows you to change exon width:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Actb"</span>,<span class="st">"Myc"</span>,<span class="st">"Mtdh"</span><span class="op">)</span>,</span>
<span>               exon_width <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t22.png" style="width:100.0%"></div>
<p><strong>gene_dist_mark_params</strong> and <strong>gene_dist_mark_text_params</strong> control the segment
(<strong><em>arrow direction stands for transciption direction</em></strong>) and chromosome label styles upper the transcript:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Actb"</span>,<span class="st">"Myc"</span><span class="op">)</span>,</span>
<span>               gene_dist_mark_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>,size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>               gene_dist_mark_text_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>,size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t23.png" style="width:100.0%"></div>
<p>Viewing transcript structures for gene if you do not supply with any signal data
(bigwig,peaks …):</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dnaaf5"</span>,<span class="st">"Zfp68"</span>,<span class="st">"Pabpc1"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t24.png" style="width:100.0%"></div>
</div>
<div id="x-axis-limitation" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> X axis limitation<a class="anchor" aria-label="anchor" href="#x-axis-limitation"><i class="fas fa-link"></i></a>
</h2>
<p>Basiclly <strong>trackVisProMax</strong> is constructed based on the ggplot. But you can’t
directlly use <strong>ggplot2::xlim</strong> function to ajust the X axis limitation.
<strong>xlimit_range</strong> parameter is supplied to control the X axis limits which can
zoom your interested region:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">trackVisProMax</span><span class="op">(</span>Input_gtf <span class="op">=</span> <span class="va">gtf</span>,</span>
<span>               Input_bw <span class="op">=</span> <span class="va">bw</span>,</span>
<span>               Input_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Actb"</span>,<span class="st">"Myc"</span><span class="op">)</span>,</span>
<span>               xlimit_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">142904344</span>,<span class="fl">142904782</span><span class="op">)</span>,</span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">61987507</span>,<span class="fl">61988278</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="local_images/t25.png" style="width:100.0%"></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="track-data-input.html"><span class="header-section-number">3</span> Track data input</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#track-visualization"><span class="header-section-number">4</span> Track visualization</a></li>
<li><a class="nav-link" href="#basic-plot"><span class="header-section-number">4.1</span> Basic plot</a></li>
<li><a class="nav-link" href="#signal-range-settings"><span class="header-section-number">4.2</span> Signal range settings</a></li>
<li><a class="nav-link" href="#transcript-track-settings"><span class="header-section-number">4.3</span> Transcript track settings</a></li>
<li><a class="nav-link" href="#x-axis-limitation"><span class="header-section-number">4.4</span> X axis limitation</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>BioSeqUtils Reference</strong>" was written by Jun Zhang. It was last built on 2023-04-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
